---
const { classes } = Astro.props;
---

<div class=`auth-signed-in hidden flex justify-center w-full ${classes ?? ''}`>
    <slot />
</div>

<script>
    import { auth } from "../../lib/authStore";
    document.addEventListener("astro:page-load", () => {
        // This only runs once.
        auth.subscribe((clerk) => {
            if (!!clerk && clerk?.loaded) {
                const signedIn = document.querySelectorAll(".auth-signed-in")!;
                if (!!clerk.user) {
                    signedIn.forEach((el) => {
                        el.classList.remove("hidden");
                    });
                } else {
                    signedIn.forEach((el) => {
                        el.classList.add("hidden");
                    });
                }
            }
        });
    });
</script>
